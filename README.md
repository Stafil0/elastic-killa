elastic-killa </br> [![Build status](https://ci.appveyor.com/api/projects/status/4pyqlky5g9es8ikh/branch/main?svg=true)](https://ci.appveyor.com/project/Stafil0/elastic-killa/branch/main) [![codecov](https://codecov.io/gh/Stafil0/elastic-killa/branch/main/graph/badge.svg?token=GQZKV4VK1V)](https://codecov.io/gh/Stafil0/elastic-killa)
=============
###### *Trying to create search engine by myself.*

### TL;DR
Библиотека, реализующая простейший сервис индексации текстовых файлов по словам.
- интерфейс библиотеки позволяет добавлять в систему каталоги и файлы, и выдавать список файлов содержащих заданное слово;
- поддерживает многопоточный доступ к индексу;
- отслеживает изменения файлов и состава каталогов на диске;
- расширяема по механизму разделения по словам: простое текстовое разбиение, лексеры, etc.

### Сабж

В целом, идея реализации простая - держим два индекса, один для соотвествия файл-контент *(прямой)*, другой - контент-файл *(обратный)*. Для поиска используем обратный, обновляем его по средством изменения прямого индекса. 
Реализации индексов можно легко подменять, хотел попробовать встроить реализацию для wildcard поиска (но, видимо, позже).

Дабы поддерживать индексы для папки актуальными, написал небольшую очередь для background индексации.

Для работы с файловой системой выбрал FileSystemWatcher. Для добавления конкретных файлов следует использовать маску в виде имени файла.

Решение вышло только под ~~шиндоус~~ Windows из-за нормализации путей под ОСь.

### CLI

Для работы с библиотекой приложен небольшой проект с CLI. Команды максимально простые.

Команда | Описание
-- | --
`q <word>`  | Поиск без ожидания окончания индексации.
`qw <word>` | Поиск с ожиданием окончания индексации.
`sub <folder> <mask>` | Подписаться изменение файлов в папке. Если необходимо подписаться на конкретный файл, то следует использовать имя файла в качестве маски. Параметр `<mask>` необязательный, если он не передан, то будут отслеживаться изменения всех файлов в папке.
`unsub <folder> <mask>` |  Отписаться от папки/папки+маски. Если параметр `<mask>` не передан, то произойдет отписка от папки без учета наличия нескольких масок для неё.
`index?`  | Проверить, индексируется ли что-то сейчас.
`sub?` | Получить список подписок.
`exit` | Для выхода из CLI.


### API

Основным классом является `FileAnalyzer`, который может принимать на вход экземпляр класса `ITokenizer` и индексы, реализующие `IIndex` или пару `ISearcher`, `IIndexer`.

По умолчанию, для индексации (как прямой, так и обратной) используется `StringIndex`, который индексирует по целому слову.


### TODO

- [x] индексация текстовых файлов по словам;
- [x] добавлять каталоги и файлы, отслеживать изменения;
- [x] производить поиск по слову;
- [x] многопоточный доступ;
- [x] возможность расширения через кастомный токенизатор;
- [x] CLI;
- [x] кучку тестов;
- [x] кучку зеленых тестов;

*Свои доп-плюшки:*
- [ ] индекс с поддержкой wildcard-поиска ([например](https://ru.wikipedia.org/wiki/Префиксное_дерево "например"));
- [ ] сохранение и загрузка индексов (поддержка состояния).
